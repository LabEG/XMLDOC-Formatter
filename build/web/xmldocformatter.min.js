var LabEG=this.LabEG||{};if(LabEG.Lib=LabEG.Lib||{},LabEG.Lib.XMLDOCFormatter)throw new Error("Redefine: LabEG.Lib.XMLFormatter");!function(){"use strict";LabEG.Lib.XMLDOCFormatter=function(){var o=this;this.options={charsBetweenTags:"\r\n",charsForTabs:"    "},this.onLog=function(o){console.log("XMLFormatter log: ",o)},this.onWarning=function(o){console.warn("XMLFormatter warning: ",o)},this.onError=function(o){console.error("XMLFormatter error: ",o)};var t="",e="",n=!1,r=0,s=[],a=0,i="",g=0,h={XMLTagOpen:/^<[^!\/].*?>/,XMLTagClose:/^<\/.*?>/,XMLComment:/^<!--.*?-->/,HTMLSpecTag:/^<![^<>]*?>/,HTMLNotPairedTags:/^<(meta|link|img|br)[^<>]*?>/,XMLTagWithoutPaier:/^<[^<>]*?\/>/,SimpleText:/^[^<>]+/,EmptyTextNode:/^(\r|\n|\r\n|\s)+/};this.format=function(l){for(e="",n=!1,a=0,l=t+l;!n;)if(s=l.match(h.EmptyTextNode)){for(l=l.substring(s[0].length,l.length),i="",g=0;r>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Empty text node or new line.")}else if(s=l.match(h.XMLTagWithoutPaier)){for(l=l.substring(s[0].length,l.length),i="",g=0;r>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Tag without pair: "+s[0]),e+=i+s[0]+o.options.charsBetweenTags}else if(s=l.match(h.HTMLNotPairedTags)){for(l=l.substring(s[0].length,l.length),i="",g=0;r>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Not paired html tag: "+s[0]),e+=i+s[0]+o.options.charsBetweenTags}else if(s=l.match(h.XMLTagOpen)){for(l=l.substring(s[0].length,l.length),i="",g=0;r>g;g+=1)i+=o.options.charsForTabs;r+=1,o.onLog(i+"Tag open: "+s[0]),e+=i+s[0]+o.options.charsBetweenTags}else if(s=l.match(h.XMLTagClose)){for(l=l.substring(s[0].length,l.length),r-=1,i="",g=0;r>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Tag close: "+s[0]),e+=i+s[0]+o.options.charsBetweenTags}else if(s=l.match(h.SimpleText)){for(l=l.substring(s[0].length,l.length),s[0]=s[0].replace(/\r|\n|\r\n|\s{2,}/g),i="",g=0;r>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Simple text: "+s[0]),e+=i+s[0]+o.options.charsBetweenTags}else if(s=l.match(h.XMLComment)){for(l=l.substring(s[0].length,l.length),i="",g=0;r>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"HTML comment: "+s[0]),e+=i+s[0]+o.options.charsBetweenTags}else if(s=l.match(h.HTMLSpecTag)){for(l=l.substring(s[0].length,l.length),i="",g=0;r>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"HTML spec tag: "+s[0]),e+=i+s[0]+o.options.charsBetweenTags}else 0!==l.length?l.length>0?(t=l,n=!0,o.onError("Parsing All block ended, ending is cached to next cycle.")):(a+=1,a>3&&(n=!0,this.onWarning("Cycles limit."))):(n=!0,t="",o.onLog("Parsing All block complete."));return e},this.clear=function(){t="",r=0}},module&&(module.exports=LabEG.Lib.XMLDOCFormatter)}();