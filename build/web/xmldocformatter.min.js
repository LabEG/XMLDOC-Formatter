var LabEG=this.LabEG||{};if(LabEG.Lib=LabEG.Lib||{},LabEG.Lib.XMLFormatter)throw new Error("Redefine: LabEG.Lib.XMLFormatter");!function(){"use strict";LabEG.Lib.XMLFormatter=function(){var o=this;this.options={charsBetweenTags:"\r\n\r\n",charsForTabs:"    "},this.onLog=function(o){console.log("XMLFormatter log: ",o)},this.onWarning=function(o){console.warn("XMLFormatter warning: ",o)},this.onError=function(o){console.error("XMLFormatter error: ",o)};var e="",t="",n=!1,s=0,r=[],a=0,i="",g=0,h={XMLTagOpen:/^<[^!\/].*?>/,XMLTagClose:/^<\/.*?>/,HTMLComment:/^<!--[^><]*?-->/,HTMLCommentOpen:/^<!--.*?[^-]{2}>/,HTMLCommentClose:/^<[^<>]*?-->/,HTMLSpecTag:/^<![^<>]*?>/,HTMLNotPairedTags:/^<(meta|link|img|br)[^<>]*?>/,XMLTagWithoutPaier:/^<[^<>]*?\/>/,SimpleText:/^[^<>]+/,EmptyTextNode:/^(\r|\n|\r\n|\s)+/};this.format=function(l){for(t="",n=!1,s=0,a=0;!n;)if(r=l.match(h.EmptyTextNode)){for(l=l.substring(r[0].length,l.length),i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Empty text node or new line.")}else if(r=l.match(h.XMLTagWithoutPaier)){for(l=l.substring(r[0].length,l.length),i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Tag without pair: "+r[0]),t+=i+r[0]+o.options.charsBetweenTags}else if(r=l.match(h.HTMLNotPairedTags)){for(l=l.substring(r[0].length,l.length),i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Not paired html tag: "+r[0]),t+=i+r[0]+o.options.charsBetweenTags}else if(r=l.match(h.XMLTagOpen)){for(l=l.substring(r[0].length,l.length),i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;s+=1,o.onLog(i+"Tag open: "+r[0]),t+=i+r[0]+o.options.charsBetweenTags}else if(r=l.match(h.XMLTagClose)){for(l=l.substring(r[0].length,l.length),s-=1,i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Tag close: "+r[0]),t+=i+r[0]+o.options.charsBetweenTags}else if(r=l.match(h.SimpleText)){for(l=l.substring(r[0].length,l.length),r[0]=r[0].replace(/\r|\n|\r\n|\s{2,}/g),i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"Simple text: "+r[0]),t+=i+r[0]+o.options.charsBetweenTags}else if(r=l.match(h.HTMLComment)){for(l=l.substring(r[0].length,l.length),i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"HTML comment: "+r[0]),t+=i+r[0]+o.options.charsBetweenTags}else if(r=l.match(h.HTMLCommentOpen)){for(l=l.substring(r[0].length,l.length),i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;s+=1,o.onLog(i+"HTML comment open: "+r[0]),t+=i+r[0]+o.options.charsBetweenTags}else if(r=l.match(h.HTMLCommentClose)){for(l=l.substring(r[0].length,l.length),s-=1,i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"HTML comment close: "+r[0]),t+=i+r[0]+o.options.charsBetweenTags}else if(r=l.match(h.HTMLSpecTag)){for(l=l.substring(r[0].length,l.length),i="",g=0;s>g;g+=1)i+=o.options.charsForTabs;o.onLog(i+"HTML spec tag: "+r[0]),t+=i+r[0]+o.options.charsBetweenTags}else 0!==l.length?l.length>0?(e=l,n=!0,o.onLog("Parsing All block ended, ending is cached to next cycle.")):(a+=1,a>3&&(n=!0,this.onWarning("Cycles limit."))):(n=!0,e="",o.onLog("Parsing All block complete."));return t}},module&&(module.exports=new LabEG.Lib.XMLFormatter)}();