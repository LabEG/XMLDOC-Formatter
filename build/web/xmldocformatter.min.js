var LabEG=this.LabEG||{};if(LabEG.Lib=LabEG.Lib||{},LabEG.Lib.XMLDOCFormatter)throw new Error("Redefine: LabEG.Lib.XMLFormatter");!function(){"use strict";LabEG.Lib.XMLDOCFormatter=function(){var e=this;this.options={charsBetweenTags:"\r\n",charsForTabs:"    ",notPairedTags:"meta|link|img|br|input|param|hr|wbr".split("|"),isMultilineAttributes:!1},this.logLevels={none:0,debug:1,verbose:2,errors:4,warnings:8},this.onLog=function(e){console.log("XMLFormatter log: ",e)},this.onWarning=function(e){console.log("XMLFormatter warning: ",e)},this.onError=function(e){console.log("XMLFormatter error: ",e)},this.onStyle=function(e){return e},this.onScript=function(e){return e};var t="",n="",o=!1,r=0,s=[],i=0,a="",g=[],l=1,c=0;this.regexps={Comment:/^<!--.*?-->/,Tag:/^<[\s\S]*?>/,Text:/^[^<]+/,Empty:/^(\s)+/},this.format=function(h){for(n="",o=!1,i=0,h=t+h;!o;)if(void 0!==g[r-1]&&-1!==["style","script"].indexOf(g[r-1].tag)&&(s=h.match(/^([\s\S]*?)<\/[\s]*?(script|style)>/),s&&(h=h.substring(s[1].length,h.length),console.log(s[1]),e.onLog(a))),s=h.match(e.regexps.Empty))h=h.substring(s[0].length,h.length),e.onLog(a+"Empty text node or new line.");else if(s=h.match(e.regexps.Comment)){for(h=h.substring(s[0].length,h.length),a="",c=0;r>c;c+=1)a+=e.options.charsForTabs;l+=1,e.onLog(a+"HTML comment: "+s[0]),n+=a+s[0]+e.options.charsBetweenTags}else if(s=h.match(e.regexps.Tag)){for(h=h.substring(s[0].length,h.length),s[0]=s[0].replace(/\r|\n|\r\n/g,"").replace(/\s{2,}/g," ").replace(/^<\s+/g,"<").replace(/\s+>$/g,">"),s[0].match(/^<\//)&&(r-=1,g[r].tag!==s[0].match(/^<\/(.*?)[\s>]/)[1]?e.onWarning("Not corrected closed tag: "+g[r].lineNumber+". "+g[r].tag+" - "+l+". "+s[0].match(/^<\/(.*?)[\s>]/)[1]):g[r]=null),a="",c=0;r>c;c+=1)a+=e.options.charsForTabs;s[0].match(/^<[!\/]/)||s[0].match(/\/>$/)||(g[r]={lineNumber:l,tag:s[0].match(/^<(.*?)[\s>]/)[1]},-1===e.options.notPairedTags.indexOf(g[r].tag)&&(r+=1)),l+=1,e.onLog(a+"Tag: "+s[0]),n+=a+s[0]+e.options.charsBetweenTags}else if(s=h.match(e.regexps.Text)){for(h=h.substring(s[0].length,h.length),s[0]=s[0].replace(/\r|\n|\r\n/g,"").replace(/\s{2,}/g," "),a="",c=0;r>c;c+=1)a+=e.options.charsForTabs;l+=1,e.onLog(a+"Simple text: "+s[0]),n+=a+s[0]+e.options.charsBetweenTags}else 0!==h.length?h.length>0?(t=h,o=!0,e.onLog("Parsing All block ended, ending is cached to next cycle.")):(i+=1,i>3&&(o=!0,e.onWarning("Cycles limit."))):(o=!0,t="",e.onLog("Parsing All block complete."));return n},this.clear=function(){t="",r=0,g.length=0}},"undefined"!=typeof module&&null!==module&&module.exports?module.exports=LabEG.Lib.XMLDOCFormatter:"function"==typeof define&&define.amd&&define(function(){return LabEG.Lib.XMLDOCFormatter})}();